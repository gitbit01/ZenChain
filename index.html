<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <title>ZenChain — Play, Learn, Earn</title>
  <meta name="description" content="ZenChain demo site: connect wallet, view ZTC balance, play mini-game with spinner rewards." />
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#7c3aed;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box;}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system;backdrop-filter:blur(4px);background:linear-gradient(180deg,#071029 0%,#071530 100%);color:#e6eef8}
    .container{max-width:1100px;margin:36px auto;padding:24px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo img{height:48px;width:48px;border-radius:10px;}
    h1{font-size:20px;margin:0}
    nav{display:flex;gap:10px}
    .btn{background:var(--accent);border:none;padding:10px 14px;border-radius:10px;color:white;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
    main{display:grid;grid-template-columns:1fr 360px;gap:20px;margin-top:28px}
    .card{background:var(--card);padding:18px;border-radius:14px;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
    .hero{padding:28px;border-radius:14px;background:linear-gradient(180deg,rgba(124,58,237,0.12),transparent)}
    .muted{color:var(--muted);font-size:14px}
    .small{font-size:13px}
    .token-row{display:flex;align-items:center;justify-content:space-between;margin-top:12px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,"Roboto Mono",monospace;background:var(--glass);padding:6px 8px;border-radius:8px;word-break:break-all;overflow-wrap:break-word;}
    footer{margin-top:28px;text-align:center;color:var(--muted);font-size:13px}
    .feature-list{display:grid;gap:10px;margin-top:12px}
    .feature{display:flex;gap:12px;align-items:flex-start}
    .dot{width:10px;height:10px;border-radius:3px;background:var(--accent);margin-top:6px}
    @media (max-width:880px){main{grid-template-columns:1fr}.container{margin:16px}}

    /* Spinner Styles */
    #spinnerWrapper{position:relative;width:280px;height:280px;margin:20px auto;}
    #spinner{width:100%;height:100%;border-radius:50%;border:10px solid var(--glass);display:grid;place-items:center;position:relative;transition:transform 4s cubic-bezier(0.33,1,0.68,1);box-shadow:0 0 20px rgba(124,58,237,0.4);background:conic-gradient(#ff4d4d 0deg 60deg,#4ade80 60deg 120deg,#facc15 120deg 180deg,#3b82f6 180deg 240deg,#f472b6 240deg 300deg,#f97316 300deg 360deg);}
    #spinner .slice{position:absolute;width:50%;height:50%;top:0;right:50%;transform-origin:100% 100%;display:flex;align-items:center;justify-content:flex-end;padding-right:10px;font-weight:600;font-size:16px;color:white;text-shadow:0 0 3px black;}
    #pointer{
        width:0;
        height:0;
        border-left:15px solid transparent;
        border-right:15px solid transparent;
        border-top:30px solid var(--accent);
        position:absolute;top:-20px;
        left:50%;
        transform:translateX(-50%);z-index:10;
        
    }
    #spinModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);z-index:9999;display:flex;justify-content:center;align-items:center;}
    #spinModal div{background:white;padding:24px;border-radius:12px;max-width:300px;text-align:center;}
    #spinReward{font-weight:700;font-size:22px;margin-bottom:16px;background-color: #071029;}
    #spinOkBtn{padding:8px 16px;border:none;background:#7c3aed;color:white;border-radius:8px;font-weight:600;cursor:pointer;}
  </style>
</head>
<body>
<div class="container">
<header>
  <div class="brand">
    <div class="logo"><img src="zenchainlogo.png" alt="ZenChain Logo"></div>
    <div>
      <h1>ZenChain — Play, Learn, Earn</h1>
      <div class="muted">A polished demo site for your competition entry</div>
    </div>
  </div>
  <nav>
    <button id="connectBtn" class="btn">Connect Wallet</button>
    <button id="faucetBtn" class="btn ghost">Use Faucet (pay fee)</button>
  </nav>
</header>

<main>
<section>
  <div class="card hero">
    <h2>Welcome to ZenChain</h2>
    <p class="muted">Spin the wheel to try your luck! Rewards: 0, 0.1, 1, 2 ZTC.</p>
    <div style="display:flex;gap:14px;margin-top:16px;align-items:center;flex-wrap:wrap">
      <div class="card" style="flex:1;min-width:220px">
        <div class="small muted">Token (ZTC)</div>
        <div class="token-row">
          <div style="font-weight:700">Zen Token Balance</div>
          <div class="mono" id="tokenAddress">0.0 ZTC</div>
        </div>
        <div class="muted small" style="margin-top:8px">Connect wallet to view your ZTC balance.</div>
      </div>
      <div class="card" style="width:240px;display:flex;flex-direction:column;gap:8px">
        <div class="muted small">Connected account</div>
        <div id="account" class="mono">Not connected</div>
        <div class="muted small">ZTC Balance</div>
        <div id="balance" style="font-weight:700">—</div>
      </div>
    </div>
  </div>

  <!-- Spinner Modal -->
<div id="spinModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);z-index:9999;justify-content:center;align-items:center;">
  <div style="background:linear-gradient(135deg, #f9fafb, #e5e7eb);padding:28px;border-radius:16px;max-width:320px;text-align:center;box-shadow:0 6px 18px rgba(0,0,0,0.2);">
    <div id="spinReward" style="font-weight:700;font-size:22px;margin-bottom:18px;color:#111827;">You won: 0 ZTC</div>
    <button id="spinOkBtn" style="padding:10px 20px;border:none;background:#7c3aed;color:white;border-radius:10px;font-weight:600;cursor:pointer;transition:0.3s;">OK</button>
  </div>
</div>


  <!-- Spinner Game -->
  <div class="card" style="margin-top:16px;text-align:center">
    <h3>Spin for Zen</h3>
    <p class="muted small">Click spin to try your luck. You may win ZTC or get 0!</p>
    <div id="spinnerWrapper">
      <div id="spinner">
        <div class="slice" style="transform:rotate(0deg)">0 ZTC</div>
        <div class="slice" style="transform:rotate(60deg)">0.1 ZTC</div>
        <div class="slice" style="transform:rotate(120deg)">0 ZTC</div>
        <div class="slice" style="transform:rotate(180deg)">1 ZTC</div>
        <div class="slice" style="transform:rotate(240deg)">0 ZTC</div>
        <div class="slice" style="transform:rotate(300deg)">2 ZTC</div>
      </div>
      <div id="pointer"></div>
    </div>
    <button id="spinBtn" class="btn" style="margin-top:10px">Spin</button>
    <div style="margin-top:12px" class="muted small">Last spin reward: <span id="lastSpin">—</span> ZTC</div>
    <div style="margin-top:6px" class="muted small">High score (local ZTC): <span id="highScore">0</span></div>
  </div>
</section>

<aside>
  <div class="card">
    <h3>Quick controls</h3>
    <div style="display:grid;gap:10px;margin-top:10px">
      <button id="copyDocs" class="btn ghost">Read Document</button>
      <button id="viewOnExplorer" class="btn ghost">Open Token on Explorer</button>
      <button id="requestFaucet" class="btn">Request Faucet Tokens</button>
    </div>
  </div>
</aside>
</main>
</div>

<footer class="card" style="margin-top:28px;display:flex;flex-direction:column;align-items:center;gap:12px;padding:16px">
  <div class="muted small">Connect with ZenChain:</div>
  <div style="display:flex;gap:14px;flex-wrap:wrap">
    <a href="https://x.com/zen_chain" target="_blank" style="display:grid;place-items:center;width:40px;height:40px;border-radius:50%;background:var(--glass)">
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/x.svg" alt="X" style="width:20px;height:20px;filter:invert(1)">
    </a>
    <a href="https://discord.com/invite/zenchain" target="_blank" style="display:grid;place-items:center;width:40px;height:40px;border-radius:50%;background:var(--glass)">
     
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/discord.svg" alt="Discord" style="width:20px;height:20px;filter:invert(1)">
    </a>
    <a href="https://t.me/ZenchainAnnouncements" target="_blank" style="display:grid;place-items:center;width:40px;height:40px;border-radius:50%;background:var(--glass)">
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/telegram.svg" alt="Telegram" style="width:20px;height:20px;filter:invert(1)">
    </a>
    <a href="https://www.zenchain.io/" target="_blank" style="display:grid;place-items:center;width:40px;height:40px;border-radius:50%;background:var(--glass)">
      <img src="zenchainlogo.png" alt="Website" style="width:20px;height:20px;filter:invert(1)">
    </a>
    <a href="https://github.com/zenchain-protocol" target="_blank" style="display:grid;place-items:center;width:40px;height:40px;border-radius:50%;background:var(--glass)">
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/github.svg" alt="GitHub" style="width:20px;height:20px;filter:invert(1)">
    </a>
  </div>
  <div class="muted small" style="margin-top:6px;">Built for demo — expand features and integrate real smart contracts for full functionality.</div>
</footer>

<script>
const ZTC_TOKEN='0.0 ZTC';
const ERC20_ABI=["function balanceOf(address) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)"];
const accountEl=document.getElementById('account');
const balanceEl=document.getElementById('balance');
const tokenAddrEl=document.getElementById('tokenAddress');
const connectBtn=document.getElementById('connectBtn');
const readDocsBtn=document.getElementById('copyDocs');
const viewOnExplorer=document.getElementById('viewOnExplorer');
const requestFaucet=document.getElementById('requestFaucet');
const faucetBtn=document.getElementById('faucetBtn');
const spinBtn=document.getElementById('spinBtn');
const lastSpin=document.getElementById('lastSpin');
const highScoreEl=document.getElementById('highScore');
const spinner=document.getElementById('spinner');
const spinModal=document.getElementById('spinModal');
const spinRewardEl=document.getElementById('spinReward');
const spinOkBtn=document.getElementById('spinOkBtn');

let provider, signer, userAddress, tokenContract, tokenDecimals=18, tokenSymbol='ZTC';
tokenAddrEl.textContent=ZTC_TOKEN;

// Wallet connect & balance
async function connectWallet(){
  if(!window.ethereum){ alert('Install MetaMask'); return; }
  try{
    await window.ethereum.request({ method:'eth_requestAccounts' });
    provider=new ethers.providers.Web3Provider(window.ethereum);
    signer=provider.getSigner();
    userAddress=await signer.getAddress();
    accountEl.textContent=userAddress;
    connectBtn.textContent='Connected';
    connectBtn.classList.add('ghost');
    tokenContract=new ethers.Contract(ZTC_TOKEN,ERC20_ABI,provider);
    try{ tokenDecimals=await tokenContract.decimals(); }catch(e){ tokenDecimals=18; }
    try{ tokenSymbol=await tokenContract.symbol(); }catch(e){ tokenSymbol='ZTC'; }
    await updateBalance();
  }catch(err){ console.error(err); alert('Connection failed: '+err.message);}
}
async function updateBalance(){
  if(!tokenContract||!userAddress) return;
  try{
    const raw=await tokenContract.balanceOf(userAddress);
    const formatted=ethers.utils.formatUnits(raw,tokenDecimals);
    balanceEl.textContent=formatted+' '+tokenSymbol;
  }catch(e){ console.error(e); balanceEl.textContent='—';}
}
connectBtn.addEventListener('click',connectWallet);
readDocsBtn.addEventListener('click',()=>window.open('https://docs.zenchain.io/','_blank'));
viewOnExplorer.addEventListener('click',()=>window.open('https://zentrace.io/token/'+ZTC_TOKEN,'_blank'));
requestFaucet.addEventListener('click',()=>window.open('https://faucet.zenchain.io/','_blank'));
faucetBtn.addEventListener('click',()=>window.open('https://faucet.zenchain.io/','_blank'));

// Spinner Game
spinBtn.addEventListener('click',()=>{
  const rewards=[0,0,0.1,1,2,0]; 
  const randIndex=Math.floor(Math.random()*6);
  const reward=rewards[randIndex];
  const deg=360*5 + randIndex*60 + 30; // 5 spins + center of slice
  spinner.style.transition='transform 4s cubic-bezier(0.33,1,0.68,1)';
  spinner.style.transform=`rotate(${deg}deg)`;

  setTimeout(()=>{
    lastSpin.textContent=reward;
    const prevHigh=parseFloat(localStorage.getItem('zc_high')||'0');
    if(reward>prevHigh){
      localStorage.setItem('zc_high',reward);
      highScoreEl.textContent=reward;
    } else {
      highScoreEl.textContent=prevHigh;
    }
    spinRewardEl.textContent = reward>0 ? `🎉 You won: ${reward} ZTC!` : "😢 Try again!";
    spinModal.style.display='flex';
  },4000);
});

spinOkBtn.addEventListener('click',()=>{spinModal.style.display='none';});

// load high score
(function(){ const hs=localStorage.getItem('zc_high')||'0'; highScoreEl.textContent=hs; })();
</script>
</body>
</html>
